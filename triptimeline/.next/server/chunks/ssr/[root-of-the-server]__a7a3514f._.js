module.exports=[56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},65277,(a,b,c)=>{"use strict";b.exports=a.r(15552).vendored.contexts.AppRouterContext},53262,(a,b,c)=>{"use strict";b.exports=a.r(15552).vendored.contexts.HooksClientContext},15641,(a,b,c)=>{"use strict";b.exports=a.r(15552).vendored.contexts.ServerInsertedHtml},92952,a=>{"use strict";let b=(0,a.i(14523).createClient)();async function c(){let{data:{user:a}}=await b.auth.getUser();if(!a)return null;let{data:c,error:d}=await b.from("user_profiles").select("*").eq("id",a.id).single();return d?null:c}async function d(a){let{data:{user:c}}=await b.auth.getUser();if(!c)throw Error("User not authenticated");let{error:d}=await b.from("user_profiles").update(a).eq("id",c.id);if(d)throw Error(`Failed to update profile: ${d.message}`)}async function e(a){let{data:{user:c}}=await b.auth.getUser();if(!c)return[];let{data:d,error:e}=await b.from("user_profiles").select("*").or(`full_name.ilike.%${a}%,email.ilike.%${a}%,username.ilike.%${a}%`).neq("id",c.id).limit(10);return e?[]:d||[]}async function f(a){let{data:{user:c}}=await b.auth.getUser();if(!c)throw Error("User not authenticated");let{error:d}=await b.from("friends").insert({user_id:c.id,friend_id:a,status:"pending"});if(d){if("23505"===d.code||d.message?.includes("friends_user_id_friend_id_key")){let a=Error("FRIEND_REQUEST_ALREADY_EXISTS");throw a.code="FRIEND_REQUEST_ALREADY_EXISTS",a}throw Error(`Failed to send friend request: ${d.message}`)}}async function g(a){let{data:{user:c}}=await b.auth.getUser();if(!c)throw Error("User not authenticated");let{error:d}=await b.from("friends").update({status:"accepted"}).eq("id",a).eq("friend_id",c.id);if(d)throw Error(`Failed to accept friend request: ${d.message}`);let{data:e}=await b.from("friends").select("user_id, friend_id").eq("id",a).single();if(e){let{error:a}=await b.from("friends").insert({user_id:c.id,friend_id:e.user_id,status:"accepted"});a&&a.message.includes("duplicate")}}async function h(a){let{data:{user:c}}=await b.auth.getUser();if(!c)throw Error("User not authenticated");let{error:d}=await b.from("friends").delete().eq("id",a).eq("friend_id",c.id);if(d)throw Error(`Failed to decline friend request: ${d.message}`)}async function i(a){let{data:{user:c}}=await b.auth.getUser();if(!c)throw Error("User not authenticated");let{error:d}=await b.from("friends").delete().eq("user_id",c.id).eq("friend_id",a),{error:e}=await b.from("friends").delete().eq("user_id",a).eq("friend_id",c.id);if(d||e)throw Error("Failed to remove friend")}async function j(){let{data:{user:a}}=await b.auth.getUser();if(!a)return[];try{let{data:c,error:d}=await b.from("friends").select(`
        *,
        friend_profile:user_profiles!friends_friend_id_fkey(*)
      `).eq("user_id",a.id).eq("status","accepted");if(d)return d.message?.includes('relation "public.friends" does not exist')||d.message?.includes('relation "public.user_profiles" does not exist'),[];return c||[]}catch(a){return[]}}async function k(){let{data:{user:a}}=await b.auth.getUser();if(!a)return[];try{let{data:c,error:d}=await b.from("friends").select(`
        id,
        status,
        created_at,
        from_user:user_profiles!friends_user_id_fkey(*),
        to_user:user_profiles!friends_friend_id_fkey(*)
      `).eq("friend_id",a.id).eq("status","pending");if(d){if(d.message?.includes('relation "public.friends" does not exist'))throw Error("FRIENDS_TABLE_MISSING");return[]}return c||[]}catch(a){if("FRIENDS_TABLE_MISSING"===a.message)throw a;return[]}}async function l(a,c,d="viewer"){let{data:{user:e}}=await b.auth.getUser();if(!e)throw Error("User not authenticated");let{error:f}=await b.from("trip_collaborators").insert({trip_id:a,user_id:c,role:d,invited_by:e.id,status:"pending"});if(f){if("23505"===f.code||f.message?.includes("trip_collaborators_trip_id_user_id_key")){let a=Error("TRIP_COLLABORATOR_ALREADY_INVITED");throw a.code="TRIP_COLLABORATOR_ALREADY_INVITED",a}throw Error(`Failed to invite user to trip: ${f.message}`)}}async function m(a){let{data:{user:c}}=await b.auth.getUser();if(!c)throw Error("User not authenticated");let{data:d,error:e}=await b.from("trip_collaborators").update({status:"accepted"}).eq("id",a).eq("user_id",c.id);if(e)throw Error(`Failed to accept trip invitation: ${e.message}`)}async function n(a){let{data:{user:c}}=await b.auth.getUser();if(!c)throw Error("User not authenticated");let{error:d}=await b.from("trip_collaborators").update({status:"declined"}).eq("id",a).eq("user_id",c.id);if(d)throw Error(`Failed to decline trip invitation: ${d.message}`)}async function o(a,c){let{data:{user:d}}=await b.auth.getUser();if(!d)throw Error("User not authenticated");let{error:e}=await b.from("trip_collaborators").delete().eq("trip_id",a).eq("user_id",c);if(e)throw Error(`Failed to remove user from trip: ${e.message}`)}async function p(a){let{data:c,error:d}=await b.from("trip_collaborators").select(`
      *,
      user_profile:user_profiles!trip_collaborators_user_id_fkey(*),
      inviter_profile:user_profiles!trip_collaborators_invited_by_fkey(*)
    `).eq("trip_id",a).eq("status","accepted");return d?[]:c||[]}async function q(){let{data:{user:a}}=await b.auth.getUser();if(!a)return[];try{let{data:c,error:d}=await b.from("trip_collaborators").select(`
        id,
        role,
        status,
        created_at,
        trip:trips(id, title, destination, start_date, end_date)
      `).eq("user_id",a.id).eq("status","pending");if(d){if(d.message?.includes('relation "public.trip_collaborators" does not exist')||d.message?.includes('relation "public.user_profiles" does not exist'))throw Error("FRIENDS_TABLE_MISSING");return[]}return c||[]}catch(a){if("FRIENDS_TABLE_MISSING"===a.message)throw a;return[]}}async function r(a,c,d){let{data:{user:e}}=await b.auth.getUser();if(!e)throw Error("User not authenticated");let{error:f}=await b.from("trip_collaborators").update({role:d}).eq("trip_id",a).eq("user_id",c);if(f)throw Error(`Failed to update collaborator role: ${f.message}`)}async function s(a){let{data:{user:c}}=await b.auth.getUser();if(!c)return!1;let{data:d}=await b.from("trips").select("user_id").eq("id",a).single();if(d&&d.user_id===c.id)return!0;let{data:e}=await b.from("trip_collaborators").select("role").eq("trip_id",a).eq("user_id",c.id).eq("status","accepted").single();return e&&("editor"===e.role||"owner"===e.role)}a.s(["acceptFriendRequest",()=>g,"acceptTripInvitation",()=>m,"canEditTrip",()=>s,"declineFriendRequest",()=>h,"declineTripInvitation",()=>n,"getCurrentUserProfile",()=>c,"getFriendRequests",()=>k,"getFriends",()=>j,"getTripCollaborators",()=>p,"getTripInvitations",()=>q,"inviteToTrip",()=>l,"removeFriend",()=>i,"removeFromTrip",()=>o,"searchUsers",()=>e,"sendFriendRequest",()=>f,"updateCollaboratorRole",()=>r,"updateUserProfile",()=>d])},67849,a=>{"use strict";var b=a.i(32360),c=a.i(43505),d=a.i(21805);function e({user:a}){let{signOut:e}=(0,c.useAuth)(),[f,g]=(0,d.useState)(!1),h=async()=>{await e()},i=a.user_metadata?.display_name?a.user_metadata.display_name.split(" ").map(a=>a[0]).join("").toUpperCase():a.email?.charAt(0).toUpperCase()||"U";return(0,b.jsx)("header",{className:"bg-white/80 backdrop-blur-sm border-b border-white/20 sticky top-0 z-50",children:(0,b.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,b.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,b.jsx)("a",{href:"/dashboard",className:"flex items-center hover:opacity-80 transition-opacity",children:(0,b.jsx)("div",{className:"flex-shrink-0",children:(0,b.jsx)("h1",{className:"text-2xl font-bold bg-gradient-to-r from-purple-600 to-blue-600 bg-clip-text text-transparent cursor-pointer",children:"✈️ TripTimeline"})})}),(0,b.jsxs)("nav",{className:"hidden md:flex space-x-8",children:[(0,b.jsx)("a",{href:"/dashboard",className:"text-gray-900 hover:text-purple-600 px-3 py-2 rounded-md text-sm font-medium transition-colors",children:"Dashboard"}),(0,b.jsx)("a",{href:"/dashboard/trips",className:"text-gray-500 hover:text-purple-600 px-3 py-2 rounded-md text-sm font-medium transition-colors",children:"My Trips"}),(0,b.jsx)("a",{href:"/dashboard/explore",className:"text-gray-500 hover:text-purple-600 px-3 py-2 rounded-md text-sm font-medium transition-colors",children:"Explore"})]}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsxs)("button",{onClick:()=>g(!f),className:"flex items-center space-x-3 text-sm rounded-full focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 hover:bg-gray-100 p-1 transition-colors cursor-pointer",children:[(0,b.jsx)("div",{className:"w-10 h-10 bg-gradient-to-r from-purple-500 to-blue-500 rounded-full flex items-center justify-center text-white font-semibold",children:i}),(0,b.jsxs)("div",{className:"hidden md:block text-left",children:[(0,b.jsx)("p",{className:"text-sm font-medium text-gray-900",children:a.user_metadata?.display_name||"User"}),(0,b.jsx)("p",{className:"text-xs text-gray-500",children:a.email})]}),(0,b.jsx)("svg",{className:`w-4 h-4 text-gray-400 transition-transform ${f?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),f&&(0,b.jsxs)("div",{className:"absolute right-0 mt-2 w-56 bg-white rounded-xl shadow-lg border border-gray-200 py-2 z-50",children:[(0,b.jsxs)("div",{className:"px-4 py-3 border-b border-gray-100",children:[(0,b.jsx)("p",{className:"text-sm font-medium text-gray-900",children:a.user_metadata?.display_name||"User"}),(0,b.jsx)("p",{className:"text-xs text-gray-500 truncate",children:a.email})]}),(0,b.jsx)("div",{className:"py-1",children:(0,b.jsxs)("a",{href:"/dashboard/profile",className:"flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors",children:[(0,b.jsx)("svg",{className:"w-4 h-4 mr-3 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"Profile Settings"]})}),(0,b.jsx)("div",{className:"border-t border-gray-100 py-1",children:(0,b.jsxs)("button",{onClick:h,className:"flex items-center w-full px-4 py-2 text-sm text-red-600 hover:bg-red-50 transition-colors",children:[(0,b.jsx)("svg",{className:"w-4 h-4 mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"Sign Out"]})})]})]})]})})})}a.s(["default",()=>e])},63588,a=>{a.v(b=>Promise.all(["server/chunks/ssr/All Git Clones_Travel Planner_triptimeline_src_lib_trip-service_ts_3767527a._.js"].map(b=>a.l(b))).then(()=>b(64448)))}];

//# sourceMappingURL=%5Broot-of-the-server%5D__a7a3514f._.js.map