{"version":3,"sources":["../../../../../../../All%20Git%20Clones/Travel%20Planner/triptimeline/src/lib/friend-service.ts"],"sourcesContent":["import { createClient } from './auth';\nimport { UserProfile, Friend, TripCollaborator, FriendRequest, TripInvitation } from '@/types/friends';\n\nconst supabase = createClient();\n\n// User Profile Functions\nexport async function getCurrentUserProfile(): Promise<UserProfile | null> {\n  const { data: { user } } = await supabase.auth.getUser();\n  if (!user) return null;\n\n  const { data, error } = await (supabase as any)\n    .from('user_profiles')\n    .select('*')\n    .eq('id', user.id)\n    .single();\n\n  if (error) {\n    return null;\n  }\n\n  return data;\n}\n\nexport async function updateUserProfile(updates: Partial<UserProfile>): Promise<void> {\n  const { data: { user } } = await supabase.auth.getUser();\n  if (!user) throw new Error('User not authenticated');\n\n  const { error } = await (supabase as any)\n    .from('user_profiles')\n    .update(updates)\n    .eq('id', user.id);\n\n  if (error) {\n    throw new Error(`Failed to update profile: ${error.message}`);\n  }\n}\n\nexport async function searchUsers(query: string): Promise<UserProfile[]> {\n  const { data: { user } } = await supabase.auth.getUser();\n  if (!user) return [];\n\n  const { data, error } = await (supabase as any)\n    .from('user_profiles')\n    .select('*')\n    .or(`full_name.ilike.%${query}%,email.ilike.%${query}%,username.ilike.%${query}%`)\n    .neq('id', user.id)\n    .limit(10);\n\n  if (error) {\n    return [];\n  }\n\n  return data || [];\n}\n\n// Friend Functions\nexport async function sendFriendRequest(friendId: string): Promise<void> {\n  const { data: { user } } = await supabase.auth.getUser();\n  if (!user) throw new Error('User not authenticated');\n\n  const { error } = await (supabase as any)\n    .from('friends')\n    .insert({\n      user_id: user.id,\n      friend_id: friendId,\n      status: 'pending'\n    });\n\n  if (error) {\n    if ((error as any).code === '23505' || error.message?.includes('friends_user_id_friend_id_key')) {\n      const duplicateError = new Error('FRIEND_REQUEST_ALREADY_EXISTS');\n      (duplicateError as any).code = 'FRIEND_REQUEST_ALREADY_EXISTS';\n      throw duplicateError;\n    }\n    throw new Error(`Failed to send friend request: ${error.message}`);\n  }\n}\n\nexport async function acceptFriendRequest(requestId: string): Promise<void> {\n  const { data: { user } } = await supabase.auth.getUser();\n  if (!user) throw new Error('User not authenticated');\n\n  // Update the original request to accepted\n  const { error: updateError } = await (supabase as any)\n    .from('friends')\n    .update({ status: 'accepted' })\n    .eq('id', requestId)\n    .eq('friend_id', user.id);\n\n  if (updateError) {\n    throw new Error(`Failed to accept friend request: ${updateError.message}`);\n  }\n\n  // Create the reciprocal friendship\n  const { data: originalRequest } = await (supabase as any)\n    .from('friends')\n    .select('user_id, friend_id')\n    .eq('id', requestId)\n    .single();\n\n  if (originalRequest) {\n    const { error: reciprocalError } = await (supabase as any)\n      .from('friends')\n      .insert({\n        user_id: user.id,\n        friend_id: originalRequest.user_id,\n        status: 'accepted'\n      });\n\n    if (reciprocalError && !reciprocalError.message.includes('duplicate')) {\n      // Could not create reciprocal friendship\n    }\n  }\n}\n\nexport async function declineFriendRequest(requestId: string): Promise<void> {\n  const { data: { user } } = await supabase.auth.getUser();\n  if (!user) throw new Error('User not authenticated');\n\n  const { error } = await (supabase as any)\n    .from('friends')\n    .delete()\n    .eq('id', requestId)\n    .eq('friend_id', user.id);\n\n  if (error) {\n    throw new Error(`Failed to decline friend request: ${error.message}`);\n  }\n}\n\nexport async function removeFriend(friendId: string): Promise<void> {\n  const { data: { user } } = await supabase.auth.getUser();\n  if (!user) throw new Error('User not authenticated');\n\n  // Remove both directions of the friendship\n  const { error: error1 } = await (supabase as any)\n    .from('friends')\n    .delete()\n    .eq('user_id', user.id)\n    .eq('friend_id', friendId);\n\n  const { error: error2 } = await (supabase as any)\n    .from('friends')\n    .delete()\n    .eq('user_id', friendId)\n    .eq('friend_id', user.id);\n\n  if (error1 || error2) {\n    throw new Error('Failed to remove friend');\n  }\n}\n\nexport async function getFriends(): Promise<Friend[]> {\n  const { data: { user } } = await supabase.auth.getUser();\n  if (!user) return [];\n\n  try {\n    const { data, error } = await (supabase as any)\n      .from('friends')\n      .select(`\n        *,\n        friend_profile:user_profiles!friends_friend_id_fkey(*)\n      `)\n      .eq('user_id', user.id)\n      .eq('status', 'accepted');\n\n    if (error) {\n      // Check if it's a missing table error\n      if (error.message?.includes('relation \"public.friends\" does not exist') || \n          error.message?.includes('relation \"public.user_profiles\" does not exist')) {\n        return [];\n      }\n      return [];\n    }\n\n    return data || [];\n  } catch (error) {\n    return [];\n  }\n}\n\nexport async function getFriendRequests(): Promise<FriendRequest[]> {\n  const { data: { user } } = await supabase.auth.getUser();\n  if (!user) return [];\n\n  try {\n    const { data, error } = await (supabase as any)\n      .from('friends')\n      .select(`\n        id,\n        status,\n        created_at,\n        from_user:user_profiles!friends_user_id_fkey(*),\n        to_user:user_profiles!friends_friend_id_fkey(*)\n      `)\n      .eq('friend_id', user.id)\n      .eq('status', 'pending');\n\n    if (error) {\n      // Check if it's a missing table error\n      if (error.message?.includes('relation \"public.friends\" does not exist')) {\n        throw new Error('FRIENDS_TABLE_MISSING');\n      }\n      return [];\n    }\n\n    return data || [];\n  } catch (error) {\n    if ((error as Error).message === 'FRIENDS_TABLE_MISSING') {\n      throw error; // Re-throw so NotificationBell can detect it\n    }\n    return [];\n  }\n}\n\n// Trip Collaboration Functions\nexport async function inviteToTrip(tripId: string, userId: string, role: 'editor' | 'viewer' = 'viewer'): Promise<void> {\n  const { data: { user } } = await supabase.auth.getUser();\n  if (!user) throw new Error('User not authenticated');\n\n  const { error } = await (supabase as any)\n    .from('trip_collaborators')\n    .insert({\n      trip_id: tripId,\n      user_id: userId,\n      role: role,\n      invited_by: user.id,\n      status: 'pending'\n    });\n\n  if (error) {\n    if ((error as any).code === '23505' || error.message?.includes('trip_collaborators_trip_id_user_id_key')) {\n      const duplicateError = new Error('TRIP_COLLABORATOR_ALREADY_INVITED');\n      (duplicateError as any).code = 'TRIP_COLLABORATOR_ALREADY_INVITED';\n      throw duplicateError;\n    }\n    throw new Error(`Failed to invite user to trip: ${error.message}`);\n  }\n}\n\nexport async function acceptTripInvitation(invitationId: string): Promise<void> {\n  const { data: { user } } = await supabase.auth.getUser();\n  if (!user) throw new Error('User not authenticated');\n\n  const { data, error } = await (supabase as any)\n    .from('trip_collaborators')\n    .update({ status: 'accepted' })\n    .eq('id', invitationId)\n    .eq('user_id', user.id);\n\n  if (error) {\n    throw new Error(`Failed to accept trip invitation: ${error.message}`);\n  }\n}\n\nexport async function declineTripInvitation(invitationId: string): Promise<void> {\n  const { data: { user } } = await supabase.auth.getUser();\n  if (!user) throw new Error('User not authenticated');\n\n  const { error } = await (supabase as any)\n    .from('trip_collaborators')\n    .update({ status: 'declined' })\n    .eq('id', invitationId)\n    .eq('user_id', user.id);\n\n  if (error) {\n    throw new Error(`Failed to decline trip invitation: ${error.message}`);\n  }\n}\n\nexport async function removeFromTrip(tripId: string, userId: string): Promise<void> {\n  const { data: { user } } = await supabase.auth.getUser();\n  if (!user) throw new Error('User not authenticated');\n\n  const { error } = await (supabase as any)\n    .from('trip_collaborators')\n    .delete()\n    .eq('trip_id', tripId)\n    .eq('user_id', userId);\n\n  if (error) {\n    throw new Error(`Failed to remove user from trip: ${error.message}`);\n  }\n}\n\nexport async function getTripCollaborators(tripId: string): Promise<TripCollaborator[]> {\n  const { data, error } = await (supabase as any)\n    .from('trip_collaborators')\n    .select(`\n      *,\n      user_profile:user_profiles!trip_collaborators_user_id_fkey(*),\n      inviter_profile:user_profiles!trip_collaborators_invited_by_fkey(*)\n    `)\n    .eq('trip_id', tripId)\n    .eq('status', 'accepted');\n\n  if (error) {\n    return [];\n  }\n\n  return data || [];\n}\n\nexport async function getTripInvitations(): Promise<TripInvitation[]> {\n  const { data: { user } } = await supabase.auth.getUser();\n  if (!user) return [];\n\n  try {\n    const { data, error } = await (supabase as any)\n      .from('trip_collaborators')\n      .select(`\n        id,\n        role,\n        status,\n        created_at,\n        trip:trips(id, title, destination, start_date, end_date)\n      `)\n      .eq('user_id', user.id)\n      .eq('status', 'pending');\n\n    if (error) {\n      // Check if it's a missing table error\n      if (error.message?.includes('relation \"public.trip_collaborators\" does not exist') || \n          error.message?.includes('relation \"public.user_profiles\" does not exist')) {\n        throw new Error('FRIENDS_TABLE_MISSING');\n      }\n      return [];\n    }\n\n    return data || [];\n  } catch (error) {\n    if ((error as Error).message === 'FRIENDS_TABLE_MISSING') {\n      throw error; // Re-throw so NotificationBell can detect it\n    }\n    return [];\n  }\n}\n\nexport async function updateCollaboratorRole(tripId: string, userId: string, role: 'editor' | 'viewer'): Promise<void> {\n  const { data: { user } } = await supabase.auth.getUser();\n  if (!user) throw new Error('User not authenticated');\n\n  const { error } = await (supabase as any)\n    .from('trip_collaborators')\n    .update({ role })\n    .eq('trip_id', tripId)\n    .eq('user_id', userId);\n\n  if (error) {\n    throw new Error(`Failed to update collaborator role: ${error.message}`);\n  }\n}\n\n// Check if user can edit trip\nexport async function canEditTrip(tripId: string): Promise<boolean> {\n  const { data: { user } } = await supabase.auth.getUser();\n  if (!user) return false;\n\n  // Check if user is the owner\n  const { data: trip } = await (supabase as any)\n    .from('trips')\n    .select('user_id')\n    .eq('id', tripId)\n    .single();\n\n  if (trip && trip.user_id === user.id) return true;\n\n  // Check if user is a collaborator with editor role\n  const { data: collaborator } = await (supabase as any)\n    .from('trip_collaborators')\n    .select('role')\n    .eq('trip_id', tripId)\n    .eq('user_id', user.id)\n    .eq('status', 'accepted')\n    .single();\n\n  return collaborator && (collaborator.role === 'editor' || collaborator.role === 'owner');\n}\n"],"names":[],"mappings":"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"}