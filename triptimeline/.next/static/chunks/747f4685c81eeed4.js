(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,70267,(e,t,r)=>{t.exports=e.r(26656)},11069,e=>{"use strict";let t=(0,e.i(38335).createClient)();async function r(){let{data:{user:e}}=await t.auth.getUser();if(!e)return null;let{data:r,error:i}=await t.from("user_profiles").select("*").eq("id",e.id).single();return i?null:r}async function i(e){let{data:{user:r}}=await t.auth.getUser();if(!r)throw Error("User not authenticated");let{error:i}=await t.from("user_profiles").update(e).eq("id",r.id);if(i)throw Error(`Failed to update profile: ${i.message}`)}async function a(e){let{data:{user:r}}=await t.auth.getUser();if(!r)return[];let{data:i,error:a}=await t.from("user_profiles").select("*").or(`full_name.ilike.%${e}%,email.ilike.%${e}%,username.ilike.%${e}%`).neq("id",r.id).limit(10);return a?[]:i||[]}async function s(e){let{data:{user:r}}=await t.auth.getUser();if(!r)throw Error("User not authenticated");let{error:i}=await t.from("friends").insert({user_id:r.id,friend_id:e,status:"pending"});if(i){if("23505"===i.code||i.message?.includes("friends_user_id_friend_id_key")){let e=Error("FRIEND_REQUEST_ALREADY_EXISTS");throw e.code="FRIEND_REQUEST_ALREADY_EXISTS",e}throw Error(`Failed to send friend request: ${i.message}`)}}async function o(e){let{data:{user:r}}=await t.auth.getUser();if(!r)throw Error("User not authenticated");let{error:i}=await t.from("friends").update({status:"accepted"}).eq("id",e).eq("friend_id",r.id);if(i)throw Error(`Failed to accept friend request: ${i.message}`);let{data:a}=await t.from("friends").select("user_id, friend_id").eq("id",e).single();if(a){let{error:e}=await t.from("friends").insert({user_id:r.id,friend_id:a.user_id,status:"accepted"});e&&e.message.includes("duplicate")}}async function d(e){let{data:{user:r}}=await t.auth.getUser();if(!r)throw Error("User not authenticated");let{error:i}=await t.from("friends").delete().eq("id",e).eq("friend_id",r.id);if(i)throw Error(`Failed to decline friend request: ${i.message}`)}async function n(e){let{data:{user:r}}=await t.auth.getUser();if(!r)throw Error("User not authenticated");let{error:i}=await t.from("friends").delete().eq("user_id",r.id).eq("friend_id",e),{error:a}=await t.from("friends").delete().eq("user_id",e).eq("friend_id",r.id);if(i||a)throw Error("Failed to remove friend")}async function l(){let{data:{user:e}}=await t.auth.getUser();if(!e)return[];try{let{data:r,error:i}=await t.from("friends").select(`
        *,
        friend_profile:user_profiles!friends_friend_id_fkey(*)
      `).eq("user_id",e.id).eq("status","accepted");if(i)return i.message?.includes('relation "public.friends" does not exist')||i.message?.includes('relation "public.user_profiles" does not exist'),[];return r||[]}catch(e){return[]}}async function u(){let{data:{user:e}}=await t.auth.getUser();if(!e)return[];try{let{data:r,error:i}=await t.from("friends").select(`
        id,
        status,
        created_at,
        from_user:user_profiles!friends_user_id_fkey(*),
        to_user:user_profiles!friends_friend_id_fkey(*)
      `).eq("friend_id",e.id).eq("status","pending");if(i){if(i.message?.includes('relation "public.friends" does not exist'))throw Error("FRIENDS_TABLE_MISSING");return[]}return r||[]}catch(e){if("FRIENDS_TABLE_MISSING"===e.message)throw e;return[]}}async function f(e,r,i="viewer"){let{data:{user:a}}=await t.auth.getUser();if(!a)throw Error("User not authenticated");let{error:s}=await t.from("trip_collaborators").insert({trip_id:e,user_id:r,role:i,invited_by:a.id,status:"pending"});if(s){if("23505"===s.code||s.message?.includes("trip_collaborators_trip_id_user_id_key")){let e=Error("TRIP_COLLABORATOR_ALREADY_INVITED");throw e.code="TRIP_COLLABORATOR_ALREADY_INVITED",e}throw Error(`Failed to invite user to trip: ${s.message}`)}}async function c(e){let{data:{user:r}}=await t.auth.getUser();if(!r)throw Error("User not authenticated");let{data:i,error:a}=await t.from("trip_collaborators").update({status:"accepted"}).eq("id",e).eq("user_id",r.id);if(a)throw Error(`Failed to accept trip invitation: ${a.message}`)}async function _(e){let{data:{user:r}}=await t.auth.getUser();if(!r)throw Error("User not authenticated");let{error:i}=await t.from("trip_collaborators").update({status:"declined"}).eq("id",e).eq("user_id",r.id);if(i)throw Error(`Failed to decline trip invitation: ${i.message}`)}async function p(e,r){let{data:{user:i}}=await t.auth.getUser();if(!i)throw Error("User not authenticated");let{error:a}=await t.from("trip_collaborators").delete().eq("trip_id",e).eq("user_id",r);if(a)throw Error(`Failed to remove user from trip: ${a.message}`)}async function w(e){let{data:r,error:i}=await t.from("trip_collaborators").select(`
      *,
      user_profile:user_profiles!trip_collaborators_user_id_fkey(*),
      inviter_profile:user_profiles!trip_collaborators_invited_by_fkey(*)
    `).eq("trip_id",e).eq("status","accepted");return i?[]:r||[]}async function h(){let{data:{user:e}}=await t.auth.getUser();if(!e)return[];try{let{data:r,error:i}=await t.from("trip_collaborators").select(`
        id,
        role,
        status,
        created_at,
        trip:trips(id, title, destination, start_date, end_date)
      `).eq("user_id",e.id).eq("status","pending");if(i){if(i.message?.includes('relation "public.trip_collaborators" does not exist')||i.message?.includes('relation "public.user_profiles" does not exist'))throw Error("FRIENDS_TABLE_MISSING");return[]}return r||[]}catch(e){if("FRIENDS_TABLE_MISSING"===e.message)throw e;return[]}}async function m(e,r,i){let{data:{user:a}}=await t.auth.getUser();if(!a)throw Error("User not authenticated");let{error:s}=await t.from("trip_collaborators").update({role:i}).eq("trip_id",e).eq("user_id",r);if(s)throw Error(`Failed to update collaborator role: ${s.message}`)}async function g(e){let{data:{user:r}}=await t.auth.getUser();if(!r)return!1;let{data:i}=await t.from("trips").select("user_id").eq("id",e).single();if(i&&i.user_id===r.id)return!0;let{data:a}=await t.from("trip_collaborators").select("role").eq("trip_id",e).eq("user_id",r.id).eq("status","accepted").single();return a&&("editor"===a.role||"owner"===a.role)}e.s(["acceptFriendRequest",()=>o,"acceptTripInvitation",()=>c,"canEditTrip",()=>g,"declineFriendRequest",()=>d,"declineTripInvitation",()=>_,"getCurrentUserProfile",()=>r,"getFriendRequests",()=>u,"getFriends",()=>l,"getTripCollaborators",()=>w,"getTripInvitations",()=>h,"inviteToTrip",()=>f,"removeFriend",()=>n,"removeFromTrip",()=>p,"searchUsers",()=>a,"sendFriendRequest",()=>s,"updateCollaboratorRole",()=>m,"updateUserProfile",()=>i])},95997,e=>{e.v(t=>Promise.all(["static/chunks/582ad1be1e62910e.js"].map(t=>e.l(t))).then(()=>t(74765)))}]);