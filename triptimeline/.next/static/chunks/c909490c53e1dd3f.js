(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,70267,(e,t,r)=>{t.exports=e.r(26656)},11069,e=>{"use strict";let t=(0,e.i(38335).createClient)();async function r(){let{data:{user:e}}=await t.auth.getUser();if(!e)return null;let{data:r,error:s}=await t.from("user_profiles").select("*").eq("id",e.id).single();return s?null:r}async function s(e){let{data:{user:r}}=await t.auth.getUser();if(!r)throw Error("User not authenticated");let{error:s}=await t.from("user_profiles").update(e).eq("id",r.id);if(s)throw Error(`Failed to update profile: ${s.message}`)}async function a(e){let{data:{user:r}}=await t.auth.getUser();if(!r)return[];let{data:s,error:a}=await t.from("user_profiles").select("*").or(`full_name.ilike.%${e}%,email.ilike.%${e}%,username.ilike.%${e}%`).neq("id",r.id).limit(10);return a?[]:s||[]}async function i(e){let{data:{user:r}}=await t.auth.getUser();if(!r)throw Error("User not authenticated");let{error:s}=await t.from("friends").insert({user_id:r.id,friend_id:e,status:"pending"});if(s){if("23505"===s.code||s.message?.includes("friends_user_id_friend_id_key")){let e=Error("FRIEND_REQUEST_ALREADY_EXISTS");throw e.code="FRIEND_REQUEST_ALREADY_EXISTS",e}throw Error(`Failed to send friend request: ${s.message}`)}}async function o(e){let{data:{user:r}}=await t.auth.getUser();if(!r)throw Error("User not authenticated");let{error:s}=await t.from("friends").update({status:"accepted"}).eq("id",e).eq("friend_id",r.id);if(s)throw Error(`Failed to accept friend request: ${s.message}`);let{data:a}=await t.from("friends").select("user_id, friend_id").eq("id",e).single();if(a){let{error:e}=await t.from("friends").insert({user_id:r.id,friend_id:a.user_id,status:"accepted"});e&&e.message.includes("duplicate")}}async function n(e){let{data:{user:r}}=await t.auth.getUser();if(!r)throw Error("User not authenticated");let{error:s}=await t.from("friends").delete().eq("id",e).eq("friend_id",r.id);if(s)throw Error(`Failed to decline friend request: ${s.message}`)}async function l(e){let{data:{user:r}}=await t.auth.getUser();if(!r)throw Error("User not authenticated");let{error:s}=await t.from("friends").delete().eq("user_id",r.id).eq("friend_id",e),{error:a}=await t.from("friends").delete().eq("user_id",e).eq("friend_id",r.id);if(s||a)throw Error("Failed to remove friend")}async function d(){let{data:{user:e}}=await t.auth.getUser();if(!e)return[];try{let{data:r,error:s}=await t.from("friends").select(`
        *,
        friend_profile:user_profiles!friends_friend_id_fkey(*)
      `).eq("user_id",e.id).eq("status","accepted");if(s)return s.message?.includes('relation "public.friends" does not exist')||s.message?.includes('relation "public.user_profiles" does not exist'),[];return r||[]}catch(e){return[]}}async function c(){let{data:{user:e}}=await t.auth.getUser();if(!e)return[];try{let{data:r,error:s}=await t.from("friends").select(`
        id,
        status,
        created_at,
        from_user:user_profiles!friends_user_id_fkey(*),
        to_user:user_profiles!friends_friend_id_fkey(*)
      `).eq("friend_id",e.id).eq("status","pending");if(s){if(s.message?.includes('relation "public.friends" does not exist'))throw Error("FRIENDS_TABLE_MISSING");return[]}return r||[]}catch(e){if("FRIENDS_TABLE_MISSING"===e.message)throw e;return[]}}async function u(e,r,s="viewer"){let{data:{user:a}}=await t.auth.getUser();if(!a)throw Error("User not authenticated");let{error:i}=await t.from("trip_collaborators").insert({trip_id:e,user_id:r,role:s,invited_by:a.id,status:"pending"});if(i){if("23505"===i.code||i.message?.includes("trip_collaborators_trip_id_user_id_key")){let e=Error("TRIP_COLLABORATOR_ALREADY_INVITED");throw e.code="TRIP_COLLABORATOR_ALREADY_INVITED",e}throw Error(`Failed to invite user to trip: ${i.message}`)}}async function m(e){let{data:{user:r}}=await t.auth.getUser();if(!r)throw Error("User not authenticated");let{data:s,error:a}=await t.from("trip_collaborators").update({status:"accepted"}).eq("id",e).eq("user_id",r.id);if(a)throw Error(`Failed to accept trip invitation: ${a.message}`)}async function x(e){let{data:{user:r}}=await t.auth.getUser();if(!r)throw Error("User not authenticated");let{error:s}=await t.from("trip_collaborators").update({status:"declined"}).eq("id",e).eq("user_id",r.id);if(s)throw Error(`Failed to decline trip invitation: ${s.message}`)}async function h(e,r){let{data:{user:s}}=await t.auth.getUser();if(!s)throw Error("User not authenticated");let{error:a}=await t.from("trip_collaborators").delete().eq("trip_id",e).eq("user_id",r);if(a)throw Error(`Failed to remove user from trip: ${a.message}`)}async function p(e){let{data:r,error:s}=await t.from("trip_collaborators").select(`
      *,
      user_profile:user_profiles!trip_collaborators_user_id_fkey(*),
      inviter_profile:user_profiles!trip_collaborators_invited_by_fkey(*)
    `).eq("trip_id",e).eq("status","accepted");return s?[]:r||[]}async function f(){let{data:{user:e}}=await t.auth.getUser();if(!e)return[];try{let{data:r,error:s}=await t.from("trip_collaborators").select(`
        id,
        role,
        status,
        created_at,
        trip:trips(id, title, destination, start_date, end_date)
      `).eq("user_id",e.id).eq("status","pending");if(s){if(s.message?.includes('relation "public.trip_collaborators" does not exist')||s.message?.includes('relation "public.user_profiles" does not exist'))throw Error("FRIENDS_TABLE_MISSING");return[]}return r||[]}catch(e){if("FRIENDS_TABLE_MISSING"===e.message)throw e;return[]}}async function g(e,r,s){let{data:{user:a}}=await t.auth.getUser();if(!a)throw Error("User not authenticated");let{error:i}=await t.from("trip_collaborators").update({role:s}).eq("trip_id",e).eq("user_id",r);if(i)throw Error(`Failed to update collaborator role: ${i.message}`)}async function b(e){let{data:{user:r}}=await t.auth.getUser();if(!r)return!1;let{data:s}=await t.from("trips").select("user_id").eq("id",e).single();if(s&&s.user_id===r.id)return!0;let{data:a}=await t.from("trip_collaborators").select("role").eq("trip_id",e).eq("user_id",r.id).eq("status","accepted").single();return a&&("editor"===a.role||"owner"===a.role)}e.s(["acceptFriendRequest",()=>o,"acceptTripInvitation",()=>m,"canEditTrip",()=>b,"declineFriendRequest",()=>n,"declineTripInvitation",()=>x,"getCurrentUserProfile",()=>r,"getFriendRequests",()=>c,"getFriends",()=>d,"getTripCollaborators",()=>p,"getTripInvitations",()=>f,"inviteToTrip",()=>u,"removeFriend",()=>l,"removeFromTrip",()=>h,"searchUsers",()=>a,"sendFriendRequest",()=>i,"updateCollaboratorRole",()=>g,"updateUserProfile",()=>s])},93053,e=>{"use strict";var t=e.i(21227),r=e.i(84961),s=e.i(70267),a=e.i(61013),i=e.i(44586),o=e.i(38680);function n({trip:e,onDelete:r,onManageCollaborators:s,onEdit:n}){let[l,d]=(0,a.useState)(!1),c=(0,a.useRef)(null),u=new Date(e.start_date),m=new Date(e.end_date),x=(0,o.differenceInDays)(m,u)+1,h=u>new Date,p=u<=new Date&&m>=new Date;return(0,a.useEffect)(()=>{function e(e){c.current&&!c.current.contains(e.target)&&d(!1)}if(l)return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[l]),(0,t.jsxs)("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-white/20 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1 group",children:[(0,t.jsxs)("div",{className:"h-48 bg-gradient-to-br from-purple-400 via-pink-400 to-orange-400 relative overflow-hidden rounded-t-2xl",children:[e.cover_image?(0,t.jsx)("img",{src:e.cover_image,alt:e.title,className:"w-full h-full object-cover"}):null,(0,t.jsx)("div",{className:"absolute inset-0 bg-black/20"}),(0,t.jsxs)("div",{className:"absolute top-4 left-4 right-4 flex justify-between items-start",children:[p?(0,t.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[(0,t.jsx)("div",{className:"w-1.5 h-1.5 bg-green-400 rounded-full mr-1.5 animate-pulse"}),"Ongoing"]}):h?(0,t.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[(0,t.jsx)("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Upcoming"]}):(0,t.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:[(0,t.jsx)("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Completed"]}),(0,t.jsx)("button",{className:"p-2 bg-white/20 backdrop-blur-sm rounded-full hover:bg-white/30 transition-colors",children:(0,t.jsx)("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})})})]}),(0,t.jsxs)("div",{className:"absolute bottom-4 left-4 right-4",children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-white mb-1 group-hover:text-yellow-200 transition-colors",children:e.title}),(0,t.jsxs)("div",{className:"flex items-center text-white/90",children:[(0,t.jsxs)("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),(0,t.jsx)("span",{className:"text-sm",children:e.destination})]})]})]}),(0,t.jsxs)("div",{className:"p-6",children:[e.description&&(0,t.jsx)("p",{className:"text-gray-600 text-sm mb-4 line-clamp-2",children:e.description}),(0,t.jsxs)("div",{className:"space-y-3 mb-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,t.jsxs)("div",{className:"flex items-center text-gray-600",children:[(0,t.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),(0,t.jsx)("span",{children:"Duration"})]}),(0,t.jsxs)("span",{className:"font-medium text-gray-900",children:[x," ",1===x?"day":"days"]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,t.jsxs)("div",{className:"flex items-center text-gray-600",children:[(0,t.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,t.jsx)("span",{children:"Dates"})]}),(0,t.jsxs)("span",{className:"font-medium text-gray-900",children:[(0,i.format)(u,"MMM d")," - ",(0,i.format)(m,"MMM d, yyyy")]})]})]}),(0,t.jsxs)("div",{className:"flex space-x-3",children:[(0,t.jsx)("a",{href:`/itinerary/${e.id}`,className:"flex-1 bg-gradient-to-r from-purple-600 to-blue-600 text-white py-2.5 px-4 rounded-xl font-medium hover:from-purple-700 hover:to-blue-700 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 transition-all duration-200 shadow-md hover:shadow-lg transform hover:-translate-y-0.5 text-center",children:"View Itinerary"}),(0,t.jsxs)("div",{className:"relative",ref:c,children:[(0,t.jsx)("button",{onClick:()=>d(!l),className:"p-2.5 bg-gray-100 hover:bg-gray-200 rounded-xl transition-colors focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2",children:(0,t.jsx)("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"})})}),l&&(0,t.jsxs)("div",{className:"absolute right-0 top-full mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-10",children:[(0,t.jsxs)("button",{onClick:()=>{d(!1),n&&n(e.id)},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 flex items-center",children:[(0,t.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Edit Trip"]}),s&&(0,t.jsxs)("button",{onClick:()=>{d(!1),s(e.id)},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 flex items-center",children:[(0,t.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"})}),"Manage Collaborators"]}),r&&(0,t.jsxs)("button",{onClick:()=>{d(!1),window.confirm(`Are you sure you want to delete "${e.title}"? This action cannot be undone.`)&&r(e.id)},className:"w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50 flex items-center",children:[(0,t.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Delete Trip"]})]})]})]})]})]})}function l({isOpen:r,onClose:s,onTripCreated:i}){let[o,n]=(0,a.useState)({title:"",destination:"",start_date:"",end_date:"",description:""}),[l,d]=(0,a.useState)(!1),c=async t=>{t.preventDefault(),d(!0);try{let{createTrip:t}=await e.A(95997),r={id:await t({title:o.title,destination:o.destination,start_date:o.start_date,end_date:o.end_date,description:o.description||"",currency:"USD",travelers:1}),...o,created_at:new Date().toISOString()};i(r),n({title:"",destination:"",start_date:"",end_date:"",description:""})}catch(t){console.error("Error creating trip:",t);let e=t instanceof Error?t.message:"Unknown error occurred";alert(`Failed to create trip: ${e}`)}finally{d(!1)}},u=e=>{n({...o,[e.target.name]:e.target.value})};return r?(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:(0,t.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Create New Trip"}),(0,t.jsx)("button",{onClick:s,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:(0,t.jsx)("svg",{className:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,t.jsxs)("form",{onSubmit:c,className:"p-6 space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"title",className:"block text-sm font-semibold text-gray-700 mb-2",children:"Trip Title *"}),(0,t.jsx)("input",{type:"text",id:"title",name:"title",value:o.title,onChange:u,required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-200",placeholder:"e.g., Summer in Japan"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"destination",className:"block text-sm font-semibold text-gray-700 mb-2",children:"Destination *"}),(0,t.jsx)("input",{type:"text",id:"destination",name:"destination",value:o.destination,onChange:u,required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-200",placeholder:"e.g., Tokyo, Japan"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"start_date",className:"block text-sm font-semibold text-gray-700 mb-2",children:"Start Date *"}),(0,t.jsx)("input",{type:"date",id:"start_date",name:"start_date",value:o.start_date,onChange:u,required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-200"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"end_date",className:"block text-sm font-semibold text-gray-700 mb-2",children:"End Date *"}),(0,t.jsx)("input",{type:"date",id:"end_date",name:"end_date",value:o.end_date,onChange:u,required:!0,min:o.start_date,className:"w-full px-4 py-3 border border-gray-300 rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-200"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"description",className:"block text-sm font-semibold text-gray-700 mb-2",children:"Description"}),(0,t.jsx)("textarea",{id:"description",name:"description",value:o.description,onChange:u,rows:3,className:"w-full px-4 py-3 border border-gray-300 rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-200 resize-none",placeholder:"Tell us about your trip..."})]}),(0,t.jsxs)("div",{className:"flex space-x-3 pt-4",children:[(0,t.jsx)("button",{type:"button",onClick:s,className:"flex-1 px-4 py-3 border border-gray-300 text-gray-700 rounded-xl font-semibold hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition-all duration-200",children:"Cancel"}),(0,t.jsx)("button",{type:"submit",disabled:l,className:"flex-1 bg-gradient-to-r from-purple-600 to-blue-600 text-white py-3 px-4 rounded-xl font-semibold hover:from-purple-700 hover:to-blue-700 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5",children:l?(0,t.jsxs)("div",{className:"flex items-center justify-center",children:[(0,t.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,t.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,t.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Creating..."]}):"Create Trip"})]})]})]})}):null}var d=e.i(22435),c=e.i(99410);function u(){let{user:i,loading:o,signOut:u}=(0,r.useAuth)(),m=(0,s.useRouter)(),[x,h]=(0,a.useState)([]),[p,f]=(0,a.useState)(!0),[g,b]=(0,a.useState)([]),[w,v]=(0,a.useState)(!1),[y,j]=(0,a.useState)(!1),[_,N]=(0,a.useState)(!1),[k,C]=(0,a.useState)(""),[E,L]=(0,a.useState)(null),[T,q]=(0,a.useState)({title:"",description:"",start_date:"",end_date:""});return((0,a.useEffect)(()=>{o||i||m.push("/auth/login")},[i,o,m]),(0,a.useEffect)(()=>{!async function(){if(i){f(!0);try{let{getUserTrips:t}=await e.A(95997),{getTripInvitations:r}=await e.A(58304),[s,a]=await Promise.all([t(),r()]);h(s),b(a)}catch(e){h([]),b([])}finally{f(!1)}}}()},[i]),o)?(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Loading your dashboard..."})]})}):i?(0,t.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50",children:[(0,t.jsx)(c.default,{user:i}),(0,t.jsxs)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsxs)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:["Welcome back, ",i.user_metadata?.display_name||i.email?.split("@")[0],"! âœˆï¸"]}),(0,t.jsx)("p",{className:"text-gray-600",children:"Ready to plan your next adventure?"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[(0,t.jsx)("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl p-6 shadow-lg border border-white/20",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"p-3 bg-blue-100 rounded-full",children:(0,t.jsx)("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})}),(0,t.jsxs)("div",{className:"ml-4",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Trips"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:x.length})]})]})}),(0,t.jsx)("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl p-6 shadow-lg border border-white/20",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"p-3 bg-purple-100 rounded-full",children:(0,t.jsx)("svg",{className:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),(0,t.jsxs)("div",{className:"ml-4",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Upcoming Trips"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:x.filter(e=>new Date(e.start_date)>new Date).length})]})]})})]}),g.length>0&&(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Trip Invitations"}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:g.map(r=>(0,t.jsxs)("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-2xl p-6 shadow-lg border border-blue-200",children:[(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:r.trip?.title||"Trip"}),(0,t.jsxs)("p",{className:"text-sm text-gray-600 mb-1",children:["ðŸ“ ",r.trip?.destination||"Destination"]}),(0,t.jsxs)("p",{className:"text-sm text-gray-600",children:["ðŸ“… ",r.trip?.start_date?new Date(r.trip.start_date).toLocaleDateString():"Date"]}),r.inviter_profile&&(0,t.jsxs)("p",{className:"text-xs text-gray-500 mt-2",children:["Invited by: ",r.inviter_profile.full_name||r.inviter_profile.email||"Someone"]})]}),(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsx)("button",{type:"button",onClick:async()=>{try{let{acceptTripInvitation:t,getTripInvitations:s}=await e.A(58304),{getUserTrips:a}=await e.A(95997);await t(r.id);let[i,o]=await Promise.all([a(),s()]);h(i),b(o)}catch(e){alert("Failed to accept invitation")}},className:"flex-1 bg-green-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-green-700 transition-colors",children:"Accept"}),(0,t.jsx)("button",{type:"button",onClick:async()=>{try{let{declineTripInvitation:t}=await e.A(58304);await t(r.id),b(g.filter(e=>e.id!==r.id))}catch(e){alert("Failed to decline invitation")}},className:"flex-1 bg-red-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-red-700 transition-colors",children:"Decline"})]})]},r.id))})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Your Trips"}),(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsx)("a",{href:"/friends",className:"bg-white/80 backdrop-blur-sm text-purple-600 px-6 py-3 rounded-xl font-semibold hover:bg-white border border-purple-200 hover:border-purple-300 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 transition-all duration-200 shadow-sm hover:shadow-md",children:"ðŸ‘¥ Friends"}),(0,t.jsx)("button",{onClick:()=>v(!0),className:"bg-gradient-to-r from-purple-600 to-blue-600 text-white px-6 py-3 rounded-xl font-semibold hover:from-purple-700 hover:to-blue-700 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5",children:"+ Create New Trip"})]})]}),p?(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3].map(e=>(0,t.jsxs)("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl p-6 shadow-lg border border-white/20 animate-pulse",children:[(0,t.jsx)("div",{className:"h-32 bg-gradient-to-r from-gray-200 to-gray-300 rounded-lg mb-4"}),(0,t.jsx)("div",{className:"h-6 bg-gray-200 rounded mb-3"}),(0,t.jsx)("div",{className:"h-4 bg-gray-200 rounded mb-2"}),(0,t.jsx)("div",{className:"h-4 bg-gray-200 rounded mb-4"}),(0,t.jsx)("div",{className:"h-10 bg-gray-200 rounded"})]},e))}):x.length>0?(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:x.map(r=>(0,t.jsx)(n,{trip:r,onEdit:e=>{let t=x.find(t=>t.id===e);if(t){L(t);let e=e=>e.includes("T")?e.split("T")[0]:e;q({title:t.title,description:t.description||"",start_date:e(t.start_date),end_date:e(t.end_date)}),N(!0)}},onManageCollaborators:e=>{C(e),j(!0)},onDelete:async t=>{try{let{deleteTrip:r}=await e.A(95997);await r(t),h(x.filter(e=>e.id!==t));try{localStorage.removeItem(`trip_${t}_edits`)}catch(e){}}catch(e){alert("Failed to delete trip. Please try again.")}}},r.id))}):(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,t.jsx)("svg",{className:"w-12 h-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})}),(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No trips yet"}),(0,t.jsx)("p",{className:"text-gray-600 mb-6",children:"Start planning your first adventure!"}),(0,t.jsx)("button",{onClick:()=>v(!0),className:"bg-gradient-to-r from-purple-600 to-blue-600 text-white px-6 py-3 rounded-xl font-semibold hover:from-purple-700 hover:to-blue-700 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5",children:"Create Your First Trip"})]})]}),w&&(0,t.jsx)(l,{isOpen:w,onClose:()=>v(!1),onTripCreated:e=>{h([...x,e]),v(!1)}}),_&&E&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:(0,t.jsxs)("div",{className:"bg-white rounded-2xl p-6 w-full max-w-md mx-4 shadow-xl",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Edit Trip"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Trip Title"}),(0,t.jsx)("input",{type:"text",value:T.title,onChange:e=>q({...T,title:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),(0,t.jsx)("textarea",{value:T.description,onChange:e=>q({...T,description:e.target.value}),rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent resize-none"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Date"}),(0,t.jsx)("input",{type:"date",value:T.start_date,onChange:e=>q({...T,start_date:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"End Date"}),(0,t.jsx)("input",{type:"date",value:T.end_date,onChange:e=>q({...T,end_date:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]}),(0,t.jsxs)("div",{className:"flex space-x-3 mt-6",children:[(0,t.jsx)("button",{onClick:()=>N(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),(0,t.jsx)("button",{onClick:async()=>{try{if(!T.start_date||!T.end_date)return void alert("Please fill in all fields");let{updateTrip:t}=await e.A(95997),r={...T,start_date:T.start_date,end_date:T.end_date};await t(E.id,r),h(x.map(e=>e.id===E.id?{...e,...r}:e)),N(!1)}catch(e){alert("Failed to update trip")}},className:"flex-1 bg-gradient-to-r from-purple-600 to-blue-600 text-white px-4 py-2 rounded-lg hover:from-purple-700 hover:to-blue-700 transition-all",children:"Save Changes"})]})]})}),y&&k&&(0,t.jsx)(d.default,{tripId:k,isOwner:!0,onClose:()=>{j(!1),C("")}})]}):null}e.s(["default",()=>u],93053)},95997,e=>{e.v(t=>Promise.all(["static/chunks/582ad1be1e62910e.js"].map(t=>e.l(t))).then(()=>t(74765)))},58304,e=>{e.v(e=>Promise.resolve().then(()=>e(11069)))}]);